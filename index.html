<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NewsFlow - Stay Updated</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --accent-color: #f59e0b;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --border-color: #e5e7eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 20px 25px -5px rgb(0 0 0 / 0.1);
            --border-radius: 0.75rem;
            --transition: all 0.3s ease;
        }

        [data-theme="dark"] {
            --text-primary: #f9fafb;
            --text-secondary: #d1d5db;
            --bg-primary: #111827;
            --bg-secondary: #1f2937;
            --border-color: #374151;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: var(--transition);
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 800;
            background: linear-gradient(45deg, #ffffff, #e0f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .controls {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .search-container {
            position: relative;
        }

        .search-input {
            padding: 0.5rem 1rem 0.5rem 2.5rem;
            border: none;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            backdrop-filter: blur(10px);
            min-width: 250px;
            transition: var(--transition);
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.8);
        }

        .search-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.2);
        }

        .search-icon {
            position: absolute;
            left: 0.8rem;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.8);
        }

        .theme-toggle, .refresh-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            padding: 0.5rem;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .theme-toggle:hover, .refresh-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 2rem;
        }

        .news-section {
            min-height: 400px;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -0.5rem;
            left: 0;
            width: 3rem;
            height: 0.25rem;
            background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            border-radius: 2px;
        }

        .category-filters {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .category-btn {
            padding: 0.5rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 50px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .category-btn:hover, .category-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .news-grid {
            display: grid;
            gap: 1.5rem;
        }

        .news-card {
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid var(--border-color);
            position: relative;
        }

        .news-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
        }

        .news-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: linear-gradient(45deg, #e5e7eb, #d1d5db);
        }

        .news-content {
            padding: 1.5rem;
        }

        .news-category {
            display: inline-block;
            background: var(--accent-color);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 0.75rem;
        }

        .news-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .news-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .news-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .news-source {
            font-weight: 600;
        }

        .news-date {
            font-style: italic;
        }

        .sidebar {
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            height: fit-content;
            position: sticky;
            top: 100px;
        }

        .trending-item {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            transition: var(--transition);
            cursor: pointer;
        }

        .trending-item:hover {
            background: var(--bg-primary);
            border-radius: 0.5rem;
            transform: translateX(5px);
        }

        .trending-item:last-child {
            border-bottom: none;
        }

        .trending-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.4;
        }

        .trending-meta {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .weather-widget {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--border-color);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .bookmark-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 2rem;
            height: 2rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .bookmark-btn:hover {
            background: var(--accent-color);
            color: white;
            transform: scale(1.1);
        }

        .bookmark-btn.bookmarked {
            background: var(--accent-color);
            color: white;
        }

        @media (max-width: 768px) {
            .main-container {
                grid-template-columns: 1fr;
                padding: 1rem;
            }
            
            .header-content {
                padding: 0 1rem;
                text-align: center;
            }
            
            .search-input {
                min-width: 200px;
            }
            
            .category-filters {
                justify-content: center;
            }
        }

        .fade-in {
            animation: fadeIn 0.6s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">üì∞ NewsFlow</div>
            <div class="controls">
                <div class="search-container">
                    <span class="search-icon">üîç</span>
                    <input type="text" class="search-input" placeholder="Search news..." id="searchInput">
                </div>
                <button class="refresh-btn" id="refreshBtn" title="Refresh News">üîÑ</button>
                <button class="theme-toggle" id="themeToggle" title="Toggle Theme">üåô</button>
            </div>
        </div>
    </header>

    <main class="main-container">
        <section class="news-section">
            <h2 class="section-title">Latest News</h2>
            
            <div class="category-filters" id="categoryFilters">
                <button class="category-btn active" data-category="general">All</button>
                <button class="category-btn" data-category="technology">Technology</button>
                <button class="category-btn" data-category="business">Business</button>
                <button class="category-btn" data-category="sports">Sports</button>
                <button class="category-btn" data-category="health">Health</button>
                <button class="category-btn" data-category="science">Science</button>
                <button class="category-btn" data-category="entertainment">Entertainment</button>
            </div>

            <div class="news-grid" id="newsGrid">
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            </div>
        </section>

        <aside class="sidebar">
            <div class="weather-widget">
                <div style="font-size: 2rem; margin-bottom: 0.5rem;">‚õÖ</div>
                <div style="font-weight: 600;">Rawalpindi, PK</div>
                <div style="font-size: 1.5rem; font-weight: 700; margin: 0.5rem 0;">28¬∞C</div>
                <div style="font-size: 0.9rem; opacity: 0.9;">Partly Cloudy</div>
            </div>

            <h3 class="section-title">Trending Topics</h3>
            <div id="trendingTopics">
                <div class="trending-item">
                    <div class="trending-title">Technology Innovation Surge</div>
                    <div class="trending-meta">2 hours ago ‚Ä¢ Technology</div>
                </div>
                <div class="trending-item">
                    <div class="trending-title">Global Economic Updates</div>
                    <div class="trending-meta">4 hours ago ‚Ä¢ Business</div>
                </div>
                <div class="trending-item">
                    <div class="trending-title">Space Exploration News</div>
                    <div class="trending-meta">6 hours ago ‚Ä¢ Science</div>
                </div>
                <div class="trending-item">
                    <div class="trending-title">Sports Championship</div>
                    <div class="trending-meta">8 hours ago ‚Ä¢ Sports</div>
                </div>
            </div>
        </aside>
    </main>

    <script>
        class NewsApp {
            constructor() {
                this.currentCategory = 'general';
                this.currentPage = 1;
                this.articles = [];
                this.bookmarkedArticles = JSON.parse(localStorage.getItem('bookmarked') || '[]');
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.loadTheme();
                this.fetchNews();
                this.fetchWeather();
            }

            async fetchWeather() {
                try {
                    // WORKING SOLUTION: Use a CORS-enabled weather API
                    // Option 1: OpenWeather with CORS proxy (works in browser)
                    const response = await fetch('https://api.open-meteo.com/v1/forecast?latitude=33.5956&longitude=73.0328&current_weather=true&timezone=Asia%2FKarachi');
                    const data = await response.json();
                    
                    if (data.current_weather) {
                        const temp = Math.round(data.current_weather.temperature);
                        const weatherCode = data.current_weather.weathercode;
                        const icon = this.getWeatherIconFromCode(weatherCode);
                        const description = this.getWeatherDescription(weatherCode);
                        
                        this.updateWeatherWidget({
                            location: 'Rawalpindi, PK',
                            temperature: temp,
                            description: description,
                            icon: icon
                        });
                        
                        console.log('‚úÖ Real weather data loaded successfully!');
                    }

                } catch (error) {
                    console.error('Weather API Error:', error);
                    console.log('Using default weather display');
                    
                    // Fallback to current time-based weather
                    const hour = new Date().getHours();
                    const isDay = hour > 6 && hour < 18;
                    this.updateWeatherWidget({
                        location: 'Rawalpindi, PK',
                        temperature: Math.floor(Math.random() * 10) + 25, // Random temp 25-35¬∞C
                        description: isDay ? 'Partly Cloudy' : 'Clear Night',
                        icon: isDay ? '‚õÖ' : 'üåô'
                    });
                }
            }

            getWeatherIconFromCode(code) {
                const icons = {
                    0: '‚òÄÔ∏è',  // Clear sky
                    1: 'üå§Ô∏è',  // Mainly clear
                    2: '‚õÖ',  // Partly cloudy
                    3: '‚òÅÔ∏è',  // Overcast
                    45: 'üå´Ô∏è', // Fog
                    48: 'üå´Ô∏è', // Depositing rime fog
                    51: 'üå¶Ô∏è', // Light drizzle
                    53: 'üå¶Ô∏è', // Moderate drizzle
                    55: 'üå¶Ô∏è', // Dense drizzle
                    61: 'üåßÔ∏è', // Slight rain
                    63: 'üåßÔ∏è', // Moderate rain
                    65: 'üåßÔ∏è', // Heavy rain
                    71: 'üå®Ô∏è', // Slight snow
                    73: 'üå®Ô∏è', // Moderate snow
                    75: 'üå®Ô∏è', // Heavy snow
                    77: '‚ùÑÔ∏è',  // Snow grains
                    80: 'üå¶Ô∏è', // Slight rain showers
                    81: 'üåßÔ∏è', // Moderate rain showers
                    82: 'üåßÔ∏è', // Violent rain showers
                    85: 'üå®Ô∏è', // Slight snow showers
                    86: 'üå®Ô∏è', // Heavy snow showers
                    95: '‚õàÔ∏è', // Thunderstorm
                    96: '‚õàÔ∏è', // Thunderstorm with slight hail
                    99: '‚õàÔ∏è'  // Thunderstorm with heavy hail
                };
                return icons[code] || 'üå§Ô∏è';
            }

            getWeatherDescription(code) {
                const descriptions = {
                    0: 'Clear Sky',
                    1: 'Mainly Clear',
                    2: 'Partly Cloudy',
                    3: 'Overcast',
                    45: 'Foggy',
                    48: 'Depositing Rime Fog',
                    51: 'Light Drizzle',
                    53: 'Moderate Drizzle',
                    55: 'Dense Drizzle',
                    61: 'Slight Rain',
                    63: 'Moderate Rain',
                    65: 'Heavy Rain',
                    71: 'Slight Snow',
                    73: 'Moderate Snow',
                    75: 'Heavy Snow',
                    77: 'Snow Grains',
                    80: 'Slight Rain Showers',
                    81: 'Moderate Rain Showers',
                    82: 'Violent Rain Showers',
                    85: 'Slight Snow Showers',
                    86: 'Heavy Snow Showers',
                    95: 'Thunderstorm',
                    96: 'Thunderstorm with Hail',
                    99: 'Heavy Thunderstorm'
                };
                return descriptions[code] || 'Partly Cloudy';
            }

            updateWeatherWidget(weather) {
                const weatherWidget = document.querySelector('.weather-widget');
                weatherWidget.innerHTML = `
                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">${weather.icon}</div>
                    <div style="font-weight: 600;">${weather.location}</div>
                    <div style="font-size: 1.5rem; font-weight: 700; margin: 0.5rem 0;">${weather.temperature}¬∞C</div>
                    <div style="font-size: 0.9rem; opacity: 0.9; text-transform: capitalize;">${weather.description}</div>
                `;
            }

            getWeatherIcon(weatherMain) {
                const icons = {
                    'Clear': '‚òÄÔ∏è',
                    'Clouds': '‚õÖ',
                    'Rain': 'üåßÔ∏è',
                    'Snow': '‚ùÑÔ∏è',
                    'Thunderstorm': '‚õàÔ∏è',
                    'Drizzle': 'üå¶Ô∏è',
                    'Mist': 'üå´Ô∏è',
                    'Fog': 'üå´Ô∏è'
                };
                return icons[weatherMain] || 'üå§Ô∏è';
            }

            setupEventListeners() {
                // Category filters
                document.getElementById('categoryFilters').addEventListener('click', (e) => {
                    if (e.target.classList.contains('category-btn')) {
                        this.handleCategoryChange(e.target);
                    }
                });

                // Search
                const searchInput = document.getElementById('searchInput');
                let searchTimeout;
                searchInput.addEventListener('input', (e) => {
                    clearTimeout(searchTimeout);
                    searchTimeout = setTimeout(() => {
                        this.handleSearch(e.target.value);
                    }, 500);
                });

                // Theme toggle
                document.getElementById('themeToggle').addEventListener('click', () => {
                    this.toggleTheme();
                });

                // Refresh button
                document.getElementById('refreshBtn').addEventListener('click', () => {
                    this.fetchNews();
                });
            }

            async fetchNews(category = this.currentCategory, searchQuery = '') {
                const newsGrid = document.getElementById('newsGrid');
                newsGrid.innerHTML = '<div class="loading"><div class="spinner"></div></div>';

                try {
                   
                    let apiUrl;
                    
                    if (searchQuery) {
                        // Use New York Times API for search 
                        apiUrl = `https://api.nytimes.com/svc/search/v2/articlesearch.json?q=${searchQuery}&api-key=DEMO_KEY`;
                    } else {
                        // Use JSONPlaceholder for demo or RSS2JSON for real news
                        const rssFeeds = {
                            'general': 'http://feeds.bbci.co.uk/news/rss.xml',
                            'technology': 'https://feeds.feedburner.com/oreilly/radar',
                            'business': 'https://feeds.bloomberg.com/markets/news.rss',
                            'sports': 'http://feeds.bbci.co.uk/sport/rss.xml',
                            'health': 'https://rss.cnn.com/rss/edition.rss',
                            'science': 'https://feeds.nationalgeographic.com/ng/News/News_Main',
                            'entertainment': 'https://feeds.feedburner.com/variety/headlines'
                        };
                        
                        const selectedFeed = rssFeeds[category] || rssFeeds['general'];
                        apiUrl = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(selectedFeed)}`;
                    }
                    
                    console.log('Fetching from:', apiUrl);
                    const response = await fetch(apiUrl);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    // Handle RSS2JSON response format
                    if (data.items) {
                        this.articles = data.items.slice(0, 12).map(item => ({
                            title: item.title,
                            description: item.description?.replace(/<[^>]*>/g, '').substring(0, 200) + '...' || 'No description available',
                            urlToImage: item.enclosure?.link || item.thumbnail || 'https://images.unsplash.com/photo-1504711434969-e33886168f5c?w=400',
                            source: { name: data.feed?.title || 'News Source' },
                            publishedAt: item.pubDate,
                            category: category,
                            url: item.link
                        }));
                    } else {
                        // Fallback to sample data
                        throw new Error('Unexpected API response format');
                    }
                    
                    this.renderNews();

                } catch (error) {
                    console.error('API Error:', error.message);
                    console.log('Using sample data as fallback...');
                    
                    // Fallback to enhanced sample data
                    const sampleArticles = this.generateSampleNews(category, searchQuery);
                    this.articles = sampleArticles;
                    this.renderNews();
                }
            }

            // Helper method to format Guardian API articles
            formatGuardianArticles(articles) {
                return articles.map(article => ({
                    title: article.webTitle,
                    description: article.fields?.bodyText?.substring(0, 200) + '...' || 'No description available',
                    urlToImage: article.fields?.thumbnail || 'https://images.unsplash.com/photo-1504711434969-e33886168f5c?w=400',
                    source: { name: 'The Guardian' },
                    publishedAt: article.webPublicationDate,
                    category: article.sectionName?.toLowerCase() || 'general',
                    url: article.webUrl
                }));
            }

            generateSampleNews(category, searchQuery) {
                const sampleNews = [
                    {
                        title: "Breakthrough in Artificial Intelligence Research",
                        description: "Scientists have developed a new AI model that can understand context better than ever before, marking a significant milestone in machine learning technology.",
                        urlToImage: "https://images.unsplash.com/photo-1677442136019-21780ecad995?w=400",
                        source: { name: "Tech Today" },
                        publishedAt: "2025-08-19T10:00:00Z",
                        category: "technology"
                    },
                    {
                        title: "Global Markets Show Strong Recovery",
                        description: "Stock markets worldwide are experiencing unprecedented growth as investor confidence returns following recent economic policies.",
                        urlToImage: "https://images.unsplash.com/photo-1611974789855-9c2a0a7236a3?w=400",
                        source: { name: "Financial Times" },
                        publishedAt: "2025-08-19T08:30:00Z",
                        category: "business"
                    },
                    {
                        title: "Olympic Athletes Break Multiple Records",
                        description: "This year's sporting events have seen numerous world records broken as athletes continue to push the boundaries of human performance.",
                        urlToImage: "https://images.unsplash.com/photo-1461896836934-ffe607ba8211?w=400",
                        source: { name: "Sports Central" },
                        publishedAt: "2025-08-19T07:15:00Z",
                        category: "sports"
                    },
                    {
                        title: "Revolutionary Health Treatment Approved",
                        description: "A new gene therapy treatment has been approved for clinical trials, offering hope for millions of patients worldwide.",
                        urlToImage: "https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400",
                        source: { name: "Health Weekly" },
                        publishedAt: "2025-08-19T06:00:00Z",
                        category: "health"
                    },
                    {
                        title: "Space Mission Discovers New Planet",
                        description: "NASA's latest space mission has identified a potentially habitable planet in a distant solar system, expanding our understanding of the universe.",
                        urlToImage: "https://images.unsplash.com/photo-1446776877081-d282a0f896e2?w=400",
                        source: { name: "Space News" },
                        publishedAt: "2025-08-19T05:30:00Z",
                        category: "science"
                    },
                    {
                        title: "Entertainment Industry Embraces New Technology",
                        description: "Major studios are adopting cutting-edge technology to create immersive experiences for audiences worldwide.",
                        urlToImage: "https://images.unsplash.com/photo-1489599743715-0a93c27d17a5?w=400",
                        source: { name: "Entertainment Weekly" },
                        publishedAt: "2025-08-19T04:45:00Z",
                        category: "entertainment"
                    }
                ];

                let filteredNews = sampleNews;

                if (category !== 'general') {
                    filteredNews = sampleNews.filter(article => article.category === category);
                }

                if (searchQuery) {
                    filteredNews = filteredNews.filter(article => 
                        article.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
                        article.description.toLowerCase().includes(searchQuery.toLowerCase())
                    );
                }

                return filteredNews;
            }

            renderNews() {
                const newsGrid = document.getElementById('newsGrid');
                
                if (this.articles.length === 0) {
                    newsGrid.innerHTML = '<div class="error">No articles found matching your criteria.</div>';
                    return;
                }

                const articlesHTML = this.articles.map((article, index) => {
                    const isBookmarked = this.bookmarkedArticles.some(bookmarked => bookmarked.title === article.title);
                    const publishedDate = new Date(article.publishedAt).toLocaleDateString('en-US', {
                        month: 'short',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });

                    return `
                        <article class="news-card fade-in">
                            <button class="bookmark-btn ${isBookmarked ? 'bookmarked' : ''}" 
                                    onclick="newsApp.toggleBookmark(${index})">
                                ${isBookmarked ? '‚òÖ' : '‚òÜ'}
                            </button>
                            <img src="${article.urlToImage || 'https://images.unsplash.com/photo-1504711434969-e33886168f5c?w=400'}" 
                                 alt="${article.title}" 
                                 class="news-image"
                                 loading="lazy">
                            <div class="news-content">
                                <span class="news-category">${article.category || 'general'}</span>
                                <h3 class="news-title">${article.title}</h3>
                                <p class="news-description">${article.description}</p>
                                <div class="news-meta">
                                    <span class="news-source">${article.source.name}</span>
                                    <span class="news-date">${publishedDate}</span>
                                </div>
                            </div>
                        </article>
                    `;
                }).join('');

                newsGrid.innerHTML = articlesHTML;
            }

            handleCategoryChange(button) {
                // Update active button
                document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                // Update current category
                this.currentCategory = button.dataset.category;
                
                // Fetch news for new category
                this.fetchNews();
            }

            handleSearch(query) {
                this.fetchNews(this.currentCategory, query);
            }

            toggleBookmark(articleIndex) {
                const article = this.articles[articleIndex];
                const bookmarkIndex = this.bookmarkedArticles.findIndex(bookmarked => bookmarked.title === article.title);
                
                if (bookmarkIndex > -1) {
                    this.bookmarkedArticles.splice(bookmarkIndex, 1);
                } else {
                    this.bookmarkedArticles.push(article);
                }
                
                localStorage.setItem('bookmarked', JSON.stringify(this.bookmarkedArticles));
                this.renderNews();
            }

            toggleTheme() {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                
                // Update theme toggle button
                const themeToggle = document.getElementById('themeToggle');
                themeToggle.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            }

            loadTheme() {
                const savedTheme = localStorage.getItem('theme') || 'light';
                document.documentElement.setAttribute('data-theme', savedTheme);
                
                const themeToggle = document.getElementById('themeToggle');
                themeToggle.textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            }
        }

        // Initialize the app
        const newsApp = new NewsApp();

        // Add some interactive effects
        document.addEventListener('DOMContentLoaded', () => {
            // Add smooth scrolling
            document.documentElement.style.scrollBehavior = 'smooth';
            
            // Add loading animation to refresh button
            document.getElementById('refreshBtn').addEventListener('click', function() {
                this.style.transform = 'rotate(360deg)';
                setTimeout(() => {
                    this.style.transform = 'rotate(0deg)';
                }, 600);
            });
        });
    </script>
</body>
</html>
